<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>生成二叉树</title>
<!--    <script src="https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js"></script>-->
</head>
<body>
<!--<div id="main" style="width: 200px; height: 200px;"></div>-->
<div id="main">
    <div style="text-align: center">
        <label for="inputBinaryTree"></label>
        <input type="text" id="inputBinaryTree" name="请输入序列化的二叉树" placeholder="请输入序列化的二叉树">
        <button onclick="draw()">确认</button>
    </div>
    <canvas id="canvas" height="1000" width="500" style="display:block; margin: 0 auto; top: 100px"></canvas>

</div>
<script type="text/javascript">
    function draw() {
        // 清除 canvas
        ctx.clearRect(0,0,500,1000);
        var binaryTreeString = document.getElementById("inputBinaryTree").value;
        let split = binaryTreeString.split(',')
        let length = split.length;
        var nodeArray = [];
        var k = 0;
        var headValue = split[0];
        var head = {
            "value": headValue,
            "x":250,
            "y":50,
        }
        nodeArray.push(head);
        drawCircle(head)
        split.forEach((e,index)=>{
            let node = nodeArray[index];
            if(node.value !== 'null') {
                if ((k * 2 + 1) < length) {
                    let leftNode = buildLeftNode(node,split[k*2 + 1]);
                    drawCircle(leftNode);
                    // 画线
                    drwaLine(node.x- 5,node.y + 12, leftNode.x + 5, leftNode.y - 12);
                    nodeArray.push(leftNode);
                }
                if((k*2 + 2) < length){
                    let rightNode = buildRightNode(node,split[k*2 + 2]);
                    drawCircle(rightNode)
                    drwaLine(node.x + 5,node.y + 12, rightNode.x -5, rightNode.y - 12);
                    nodeArray.push(rightNode);
                }
                k++;
            }
        });
        console.log("binaryTreeString=",binaryTreeString)
    }
    function groupBy( array , f ) {
        let groups = {};
        array.forEach( function( o ) {
            let group = JSON.stringify( f(o) );
            groups[group] = groups[group] || [];
            groups[group].push( o );
        });
        return Object.keys(groups).map( function( group ) {
            return groups[group];
        });
    }
    var canvas=document.getElementById('canvas');
    var ctx=canvas.getContext('2d');
    // ctx.fillStyle='#FF0000';
    // ctx.fillRect(0,0,80,100);
    var beginX = 250;
    var lastx = 0;
    var lasty = 0;
    // for(var i = 0; i< 9;i++) {
    //
    //     var x = i * 20 + beginX;
    //     var y = i * 40 + 50
    //     drawCircle(x,y);
    //     var tempx = x + 5
    //     var tempy = y + 12
    //     if (lastx !== 0 && lasty !== 0) {
    //         console.log(lastx,lasty,x-5,y-12)
    //         drwaLine(lastx, lasty,x-5,y-12);
    //     }
    //         lastx = tempx;
    //         lasty = tempy
    //
    // }
    function buildLeftNode(node, value) {
        return {
            "value": value,
            "x": node.x - 20,
            "y": node.y + 40
        };
    }
    // 1,2,3,4,5,6,7

    function buildRightNode(node, value) {
        return {
            "value": value,
            "x": node.x + 20,
            "y": node.y + 40
        };
    }
    // 画空心圆
    function drawCircle(node) {
        ctx.beginPath();
        ctx.arc(node.x, node.y, 13, 0, 360, false);
        ctx.lineWidth = 1;
        ctx.strokeStyle = "green";
        ctx.fillText(node.value,node.x - 3,node.y + 3 ,10)
        ctx.closePath();
        ctx.stroke();//画空心圆

    }
    // 画线
    function drwaLine(beginx, beginy, endx, endy) {
        ctx.beginPath();
        ctx.moveTo(beginx,beginy)
        ctx.lineTo(endx,endy)
        ctx.closePath();
        ctx.stroke();// 画线

    }



</script>

</body>

</html>